(()=>{"use strict";var e,t,r={317:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageType=void 0,function(e){e.REFRESH_NODE_TREE_REQUEST="REFRESH_NODE_TREE_REQUEST",e.REFRESH_NODE_TREE_RESPONSE="REFRESH_NODE_TREE_RESPONSE",e.REQUEST_NODE_PROPERTY="REQUEST_NODE_PROPERTY",e.NODE_PROPERTY_RESPONSE="NODE_PROPERTY_RESPONSE",e.SET_NODE_PROPERTY_REQUEST="SET_NODE_PROPERTY_REQUEST",e.SET_NODE_PROPERTY_RESPONSE="SET_NODE_PROPERTY_RESPONSE",e.SET_TIMESCALE_REQUEST="SET_TIMESCALE_REQUEST",e.SET_TIMESCALE_RESPONSE="SET_TIMESCALE_RESPONSE",e.NEXT_FRAME_REQUEST="NEXT_FRAME_REQUEST",e.LOWER_CONNECT="LOWER_CONNECT",e.LOWER_CONNECT_SUCCESS="LOWER_CONNECT_SUCCESS",e.LOWER_CONNECT_FAIL="LOWER_CONNECT_FAIL",e.HEARTBEAT="HEARTBEAT",e.GET_AUTO_UPDATE_FLAG="GET_AUTO_UPDATE_FLAG",e.SET_AUTO_UPDATE_FLAG="SET_AUTO_UPDATE_FLAG",e.STAT_REQUEST="STAT_REQUEST",e.STAT_RESPONSE="STAT_RESPONSE"}(r||(t.MessageType=r={}))},417:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionHelper=void 0;var o=r(611),a=r(548),n=null,i=function(){function e(){}return e.detectEnvironment=function(){return!0===n?"wechat":o.WechatHelper.isSupported()?(n=!0,"wechat"):(n=!1,"unknown")},e.showIpInputDialog=function(t){"wechat"===e.detectEnvironment()?(a.Logger.log("检测到微信小游戏环境，使用WechatHelper"),o.WechatHelper.scanQRCodeForConnection(t)):a.Logger.log("未检测到支持的环境，无法显示IP输入对话框")},e}();t.ConnectionHelper=i},418:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LayaPropParse=void 0;var r=function(){function e(){}return e.is3dObject=function(t,r){if("Scene3D"===r)return!1;if(t.transform){var o=t.transform.constructor.name;if("Transform3D"==(o=e.getObfuscatedName(o)))return!0}return!1},e.parse=function(t,r){if(1==t.destroyed)return null;var o=[],a=t.name;if(!a){var n=t.constructor.name;n=e.getObfuscatedName(n),a=t.$owner?t.$owner._name||t.$owner.constructor.name:n}var i={t:"NodeInfo",v:[a,t.active]};o.push(i);var s=r;if(this.is3dObject(t,r)){var c=t.transform.localPosition,g=t.transform.localRotationEuler,l=t.transform.localScale,u={t:"Transform3D",v:[[c.x,c.y,c.z],[g.x,g.y,g.z],[l.x,l.y,l.z]]};o.push(u)}else"Scene3D"!=s&&(u={t:"Node2D",v:[[t.x,t.y],[t.width,t.height],[t.anchorX,t.anchorY],[t.scaleX,t.scaleY],[t.skewX,t.skewY],t.rotation,t.visible,t.alpha,t.mouseEnabled,t.mouseThrough,t.zOrder]},o.push(u));switch(s){case"Camera":var p={t:"Camera",v:[t.orthographic,t.orthographicVerticalSize,t.fieldOfView,t.aspectRatio,t.nearPlane,t.farPlane,t.clearFlag,[t.clearColor.r,t.clearColor.g,t.clearColor.b,t.clearColor.a],t.enableHDR,t.msaa,t.fxaa,t.cullingMask]};o.push(p);break;case"Scene3D":var d={t:"Scene3D",v:[t.ambientMode,t.ambientColor?[t.ambientColor.r,t.ambientColor.g,t.ambientColor.b,t.ambientColor.a]:[.7,.7,.7,1],t.ambientIntensity||1,t.shadowMapFrequency||1,t._reflectionsSource||0,t._reflectionsResolution||"256",t.reflectionIntensity||1,t.enableFog||!1,t.fogMode||0,t.fogStart||300,t.fogEnd||1e3,t.fogDensity||.01,t.fogColor?[t.fogColor.r,t.fogColor.g,t.fogColor.b,t.fogColor.a]:[.7,.7,.7,1]]};o.push(d);break;case"Text":var h={t:"Text",v:[t.text||"",t.fontSize||12,t.font||"Arial",t.color||"#000000",t.align||"left",t.valign||"top",t.bold||!1,t.italic||!1,t.wordWrap||!1,t.leading||0,[t.padding&&t.padding.x||0,t.padding&&t.padding.y||0]]};o.push(h);break;case"Image":var f={t:"Image",v:[t.skin||"",t.useSourceSize||!1,t.sizeGrid||"",t.color||"#FFFFFF",t.group||""]};o.push(f);break;case"Button":var y={t:"Button",v:[t.skin||"",t.label||"",t.labelFont||"",t.labelSize||12,t.labelColor||"#000000",t.labelAlign||"center",t.labelVAlign||"middle",t.labelBold||!1,t.labelItalic||!1,t.labelPadding?[t.labelPadding.left||0,t.labelPadding.top||0,t.labelPadding.right||0,t.labelPadding.bottom||0]:[0,0,0,0],t.stateNum||1,t.group||""]};o.push(y)}var E=t._components;if(E&&E.length>0)for(var v=0;v<E.length;v++){var T=E[v].constructor.name;(T=e.getObfuscatedName(T))&&(u={t:"Component",v:[T,v]},o.push(u))}return{prop:o,name:t.name,active:t.active,exId:t.exId}},e.getNodeType=function(t){return e.getObfuscatedName(t.constructor.name)},e.generateCacheKey=function(e,t,r){for(var o,a,n=(null===(o=e.constructor)||void 0===o?void 0:o.name)||"Unknown",i="",s=e,c=0;s&&c<10;){var g=Object.getPrototypeOf(s);if(!g||g===Object.prototype)break;i+=((null===(a=g.constructor)||void 0===a?void 0:a.name)||"")+"_",s=g,c++}return"".concat(n,"_").concat(i,"_").concat(t,"_").concat(r)},e.getOrCreatePropStructure=function(e,t,r){var o=this.generateCacheKey(e,t,r),a=this.propStructureCache.get(o);if(a)return a;for(var n=[],i=e;i;){for(var s=Reflect.ownKeys(i),c=s.length,g=function(e){var r=s[e];if("string"!=typeof r)return"continue";if(n.some(function(e){return e.name===r}))return"continue";var o=r.charAt(0),a="_"===o||"$"===o;if(!t&&a)return"continue";var c=Object.getOwnPropertyDescriptor(i,r),g=void 0!==(null==c?void 0:c.get),l=g&&void 0!==c.set;n.push({name:r,isPrivate:a,isGetter:g,isSetter:l})},l=0;l<c;l++)g(l);i=Object.getPrototypeOf(i)}return this.propStructureCache.set(o,n),n},e.clearCache=function(){this.propStructureCache.clear()},e.initObfuscationName=function(){var t=e.getLayaInstance();if(t){if("Stage"===t.stage.constructor.name)return;Object.keys(t).forEach(function(r){if(t[r]&&(t[r].prototype instanceof t.Node||t[r].prototype instanceof t.EventDispatcher||t[r].prototype instanceof t.Component)){var o=t[r].name;o&&e.layaObfuscationMap.set(o,r)}})}},e.getLayaInstance=function(){return void 0!==window.Laya?window.Laya:null},e.getObfuscatedName=function(t){return e.layaObfuscationMap.get(t)||t},e.getObfuscationMap=function(){return e.layaObfuscationMap},e.getAllProps=function(e,t,r){for(var o={},a=0,n=this.getOrCreatePropStructure(e,t,r);a<n.length;a++){var i=n[a],s=void 0;try{s=e[i.name]}catch(e){s=null}var c=typeof s;if(r||"function"!==c){var g="object"===c&&null!==s;o[i.name]={name:i.name,isPrivate:i.isPrivate,isGetter:i.isGetter,isSetter:i.isSetter,type:c,expandable:g,value:this.stringifyValue(s,c)}}}return o},e.stringifyValue=function(e,t){if(null===e)return"null";if(void 0===e)return"undefined";switch(t||typeof e){case"string":return e;case"number":return Number.isNaN(e)?"NaN":String(e);case"bigint":case"function":default:return String(e);case"object":return Array.isArray(e)?"array":this.getClassName(e)}},e.getClassName=function(e){var t=typeof e;if("number"===t||"string"===t)return String(e);var r=e.$owner||e.$gobj;if(r){var o=r.constructor;return(null==o?void 0:o.name)&&o.name.length>2?o.name:typeof r}var a=e.__className;if(a&&!a.toLowerCase().startsWith("laya"))return a;var n=e.constructor;return(null==n?void 0:n.name)&&n.name.length>2?n.name:typeof e},e.propStructureCache=new Map,e.layaObfuscationMap=new Map,e}();t.LayaPropParse=r},548:function(e,t){var r=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,a=0,n=t.length;a<n;a++)!o&&a in t||(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.base64Img=t.Logger=void 0;var o=function(){function e(){}return e.getHead=function(){return"[".concat((new Date).toLocaleString(),"]")},e.setLevel=function(t){e.currentLevel=t},e.getLevel=function(){return e.currentLevel},e.enable=function(){e.enabled=!0},e.disable=function(){e.enabled=!1},e.isEnabled=function(){return e.enabled},e.shouldLog=function(t){return e.enabled&&t<=e.currentLevel},e.log=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.shouldLog(e.LogLevel.LOG)&&console.log.apply(console,r([this.getHead()],t,!1))},e.warn=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.shouldLog(e.LogLevel.WARN)&&console.warn.apply(console,r([this.getHead()],t,!1))},e.error=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.shouldLog(e.LogLevel.ERROR)&&console.error.apply(console,r([this.getHead()],t,!1))},e.debug=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.shouldLog(e.LogLevel.DEBUG)&&console.debug.apply(console,r([this.getHead()],t,!1))},e.LogLevel={ERROR:0,WARN:1,LOG:2,DEBUG:3},e.currentLevel=e.LogLevel.LOG,e.enabled=!1,e}();t.Logger=o,t.base64Img="data:image/png;base64,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"},611:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WechatHelper=void 0;var o=r(317),a=r(548),n=r(820),i=function(){function e(){}return e.showNotification=function(e,t,r){if(void 0===t&&(t="info"),void 0===r&&(r=1500),a.Logger.log("[".concat(t,"] ").concat(e)),"undefined"!=typeof wx){var o="none";switch(t){case"success":o="success";break;case"error":o="error";break;case"info":case"warning":o="none"}wx.showToast({title:e,icon:o,duration:r,mask:!1})}},e.isSupported=function(){return"undefined"!=typeof wx},e.scanQRCodeForConnection=function(t){"undefined"!=typeof wx&&wx.scanCode?wx.scanCode({scanType:["qrCode"],success:function(r){a.Logger.log("扫码成功:",r.result);try{var o=JSON.parse(r.result);if(o&&o.uid&&o.url){e.uniqueId=o.uid;var n=e.parseWebSocketUrl(o.url),i=n.ip,s=n.port,c=n.iswss;i&&""!==i.trim()?(e.connectToServer(i,s,c,t,o.uid,o.url),wx.vibrateShort({type:"light"})):e.showNotification("无效地址","error")}}catch(t){e.showNotification("无效二维码","error")}},fail:function(t){a.Logger.log("扫码失败:",t),e.showNotification("扫码失败","error")}}):a.Logger.log("当前环境不支持wx.scanCode，尝试使用手动输入")},e.parseWebSocketUrl=function(e,t){void 0===t&&(t=8080);var r={ip:"",port:t,iswss:!1};if(!e)return r;var o=e;if(o.startsWith("wss://")?(r.iswss=!0,o=o.substring(6)):o.startsWith("ws://")&&(r.iswss=!1,o=o.substring(5)),o.includes(":")){var a=o.split(":");r.ip=a[0];var n=parseInt(a[1]);isNaN(n)||(r.port=n)}else r.ip=o;return r},e.buildWebSocketUrl=function(e){var t=e.ip,r=e.port,o=e.iswss;return"".concat(o?"wss://":"ws://").concat(t,":").concat(r)},e.connectToServer=function(t,r,o,n,i,s){if(void 0===o&&(o=!1),s){var c=e.parseWebSocketUrl(s);t=c.ip||t,r=c.port||r,o=c.iswss}if(t&&""!==t.trim()){if(e.buildWebSocketUrl({ip:t,port:r,iswss:o}),i&&(e.uniqueId=i,a.Logger.log("已更新uniqueId:",i)),e.socketTask)try{return void e.socketTask.close({success:function(){return a.Logger.log("成功关闭旧连接")},fail:function(e){return a.Logger.log("关闭旧连接失败",e)},complete:function(){e.socketTask=null,setTimeout(function(){e._createSocketConnection(t,r,o,n)},500)}})}catch(t){a.Logger.log("关闭旧连接时发生异常",t),e.socketTask=null}e._createSocketConnection(t,r,o,n)}else e.showNotification("服务器地址不能为空","error")},e._createSocketConnection=function(t,r,i,s){if("undefined"!=typeof wx&&wx.connectSocket)try{var c=e.buildWebSocketUrl({ip:t,port:r,iswss:i});e.socketTask=wx.connectSocket({url:c,success:function(){return a.Logger.log("WebSocket连接创建成功")},fail:function(t){a.Logger.log("WebSocket连接创建失败",t),e.showNotification("连接失败","error")}}),e.socketTask&&(e.socketTask.onOpen(function(){if(a.Logger.log("WebSocket连接已打开"),e.uniqueId)try{e.socketTask.send({data:JSON.stringify({type:o.MessageType.LOWER_CONNECT,uniqueId:e.uniqueId})})}catch(e){a.Logger.error("发送下位机连接消息失败:",e)}n.NanoManager.getInstance().start(),s&&s()}),e.socketTask.onClose(function(){a.Logger.log("WebSocket连接已关闭"),e.socketTask&&e.showNotification("连接已断开","warning"),n.NanoManager.getInstance().stop(),e.socketTask=null}),e.socketTask.onError(function(t){a.Logger.log("WebSocket连接发生错误:",t),e.showNotification("连接错误","error");try{e.socketTask.close()}catch(e){}e.socketTask=null}))}catch(t){a.Logger.error("创建WebSocket连接时发生异常:",t),e.showNotification("连接异常","error")}else a.Logger.log("当前环境不支持wx.connectSocket")},e.closeConnection=function(t){if(void 0===t&&(t=!0),!e.socketTask)return a.Logger.log("没有活动的WebSocket连接"),!1;try{return e.socketTask.close({success:function(){a.Logger.log("WebSocket连接已主动关闭"),t&&e.showNotification("已断开连接","info"),n.NanoManager.getInstance().stop()},fail:function(r){a.Logger.log("WebSocket连接关闭失败",r),t&&e.showNotification("断开连接失败","error")},complete:function(){e.socketTask=null}}),!0}catch(r){return a.Logger.log("关闭WebSocket连接时发生异常",r),e.socketTask=null,t&&e.showNotification("断开连接异常","error"),!1}},e.isConnected=function(){return null!==e.socketTask},e.uniqueId="",e.socketTask=null,e}();t.WechatHelper=i},624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LayaEngineHolder=void 0;var o=r(418),a=r(548),n=function(){function e(){this.name="Laya",this.childrenName="children",this.DebugLayerName="LayaTreeDebugLayer",this.nodeChainCache={},this.uuid=0,this.isTreeDirty=!0,o.LayaPropParse.initObfuscationName()}return e.prototype.getLayaInstance=function(){return void 0!==window.Laya?window.Laya:null},e.prototype.isCurrentEngine=function(){return null!==this.getLayaInstance()},e.prototype.getEngineVersion=function(){var e,t=this.getLayaInstance();if(t&&t.stage)return t.version||(null===(e=t.LayaEnv)||void 0===e?void 0:e.version)||void 0},e.prototype.getStage=function(){var e=this.getLayaInstance();if(e)return e.stage;var t=this.getLayaInstance();return t?t.stage:void 0},e.prototype.refreshTree=function(){var e=this.getStage();if(e){var t=e.constructor.name;t=o.LayaPropParse.getObfuscatedName(t),e.exId=0;var r={exId:0,is3D:!1,name:t,children:[],type:t};e._children?this.childrenName="_children":e._childs&&(this.childrenName="_childs");for(var a=e[this.childrenName]?e[this.childrenName].length:0,n=0;n<a;n++){var i=e[this.childrenName][n];i.name!==this.DebugLayerName&&this.buildNodeTree(i,r.children)}return this.nodeChainCache={},this.isTreeDirty=!1,r}},e.prototype.buildNodeTree=function(e,t){var r=e.exId;null!=r&&null!=r||(this.uuid+=1,r=this.uuid,e.exId=r);var a=this.getNodeName(e),n=e.constructor.name;n=o.LayaPropParse.getObfuscatedName(n);var i=o.LayaPropParse.is3dObject(e,n);"Scene3D"==n&&(i=!0);for(var s={exId:r,name:a,is3D:i,children:[],type:n},c=e[this.childrenName]?e[this.childrenName].length:0,g=0;g<c;g++){var l=e[this.childrenName][g];this.buildNodeTree(l,s.children)}t.push(s)},e.prototype.getNodeName=function(e){var t=e.constructor.name;return t=o.LayaPropParse.getObfuscatedName(t),e.$owner&&(t=e.$owner._name+"    "+e.$owner.constructor.name+"    "+t),e.name&&(t=t+"   "+e.name),t},e.prototype.getNodeProperty=function(e){var t=this.getNodeMemoryStroge(e);if(t){var r=t.constructor.name;return r=o.LayaPropParse.getObfuscatedName(r),o.LayaPropParse.parse(t,r)}},e.prototype.setNodeProperty=function(e,t,r,o){try{var n=this.getNodeMemoryStroge(e);return n?(a.Logger.log("设置节点属性: ".concat(t,".").concat(r," = ").concat(JSON.stringify(o))),"Transform3D"===t||"Node2D"===t?this.setTransformProperty(n,r,o,"Transform3D"===t):this.setNodeInfoProperty(n,r,o)):(a.Logger.warn("未找到节点 exId: ".concat(e)),!1)}catch(e){return a.Logger.error("设置节点属性失败:",e),!1}},e.prototype.setTransformProperty=function(e,t,r,o){if(!o||!e.transform){switch(t){case"Position":return void 0!==r.x&&(e.x=r.x),void 0!==r.y&&(e.y=r.y),!0;case"Size":return void 0!==r.x&&(e.width=r.x),void 0!==r.y&&(e.height=r.y),!0;case"Anchor":return void 0!==r.x&&(e.anchorX=r.x),void 0!==r.y&&(e.anchorY=r.y),!0;case"Scale":return void 0!==r.x&&(e.scaleX=r.x),void 0!==r.y&&(e.scaleY=r.y),!0;case"Skew":return void 0!==r.x&&(e.skewX=r.x),void 0!==r.y&&(e.skewY=r.y),!0;case"Rotation":return"number"==typeof r&&(e.rotation=r),!0;case"alpha":return"number"==typeof r&&(e.alpha=r),!0;case"visible":return"boolean"==typeof r?(e.visible=r,a.Logger.log("✅ 成功设置2D节点visible属性: ".concat(r)),!0):(a.Logger.warn("visible属性值类型错误: ".concat(typeof r,", 期望boolean")),!1);case"mouseEnabled":return"boolean"==typeof r?(e.mouseEnabled=r,a.Logger.log("✅ 成功设置2D节点mouseEnabled属性: ".concat(r)),!0):(a.Logger.warn("mouseEnabled属性值类型错误: ".concat(typeof r,", 期望boolean")),!1);case"mouseThrough":return"boolean"==typeof r?(e.mouseThrough=r,a.Logger.log("✅ 成功设置2D节点mouseThrough属性: ".concat(r)),!0):(a.Logger.warn("mouseThrough属性值类型错误: ".concat(typeof r,", 期望boolean")),!1);case"zOrder":if("number"==typeof r)return e.zOrder=r,a.Logger.log("✅ 成功设置2D节点zOrder属性: ".concat(r)),!0;a.Logger.warn("zOrder属性值类型错误: ".concat(typeof r,", 期望number"))}return!1}var n=e.transform;switch(t){case"Position":return void 0!==r.x&&(n.localPositionX=r.x),void 0!==r.y&&(n.localPositionY=r.y),void 0!==r.z&&(n.localPositionZ=r.z),!0;case"Rotation":return void 0!==r.x&&(n.localRotationEulerX=r.x),void 0!==r.y&&(n.localRotationEulerY=r.y),void 0!==r.z&&(n.localRotationEulerZ=r.z),!0;case"Scale":return void 0!==r.x&&(n.localScaleX=r.x),void 0!==r.y&&(n.localScaleY=r.y),void 0!==r.z&&(n.localScaleZ=r.z),!0}return!1},e.prototype.setNodeInfoProperty=function(e,t,r){if(e&&null!=e[t]){var n=e[t].constructor.name;return"Color"===(n=o.LayaPropParse.getObfuscatedName(n))?Array.isArray(r)&&r.length>=4?(e[t].r=r[0],e[t].g=r[1],e[t].b=r[2],e[t].a=r[3],e[t]=e[t],!0):(a.Logger.warn("Color值格式错误，期望[r,g,b,a]数组"),!1):(e[t]=r,!0)}return a.Logger.warn("未找到节点属性: ".concat(t)),!1},e.prototype.deleteNode=function(e){try{var t=this.getNodeMemoryStroge(e);return t?(a.Logger.log("准备删除节点: ".concat(t.name||t.constructor.name," (exId: ").concat(e,")")),"function"==typeof t.destroy?(t.destroy(),a.Logger.log("✅ 使用destroy方法成功删除节点: ".concat(t.name||t.constructor.name)),!0):"function"==typeof t.removeSelf?(t.removeSelf(),a.Logger.log("✅ 使用removeSelf方法成功删除节点: ".concat(t.name||t.constructor.name)),!0):t.parent&&"function"==typeof t.parent.removeChild?(t.parent.removeChild(t),a.Logger.log("✅ 从父节点移除成功删除节点: ".concat(t.name||t.constructor.name)),!0):(a.Logger.warn("❌ 节点没有可用的删除方法: ".concat(t.name||t.constructor.name)),!1)):(a.Logger.warn("未找到要删除的节点 exId: ".concat(e)),!1)}catch(e){return a.Logger.error("删除节点失败:",e),!1}},e.prototype.getNodeMemoryStroge=function(e){var t=this.getNodeByChainCache(e);if(t&&e==t.exId)return t;var r=this.getStage();return r?this.getNodeByExId(e,r,[]):null},e.prototype.getNodeByExId=function(e,t,r){if(t.exId==e)return this.nodeChainCache[e]=r,t;for(var o=t[this.childrenName]?t[this.childrenName].length:0,a=0;a<o;a++){var n=r.concat([a]),i=t[this.childrenName][a];if(i.exId==e)return this.nodeChainCache[e]=n,i;var s=this.getNodeByExId(e,i,n);if(s)return this.nodeChainCache[e]=n,s}},e.prototype.getNodeByChainCache=function(e){if(this.nodeChainCache){var t=this.nodeChainCache[e];if(null!=t){var r=this.getStage();if(r&&t.length>0){for(var o=0;o<t.length;o++){var a=t[o];if(!r[this.childrenName][a])return;r=r[this.childrenName][a]}return r}}}},e.prototype.setTimeScale=function(e){var t=this.getLayaInstance();return e<0?e=0:e>50&&(e=50),t&&t.timer&&(t.timer.scale=e),e},e.prototype.nextFrame=function(){a.Logger.log("执行下一帧");var e=this.getLayaInstance();if(e&&e.timer)if(0===e.timer.scale){var t=e.timer.scale;e.timer.scale=1,requestAnimationFrame(function(){e.timer.scale=t,a.Logger.log("下一帧执行完成，恢复暂停状态")})}else a.Logger.warn("只有在暂停状态下（timeScale=0）才能执行下一帧");else a.Logger.warn("未找到Laya引擎实例或timer对象")},e.prototype.pluginSetNodeByKey=function(e,t,r){var o=this.getNodeMemoryStroge(e);o&&void 0!==o[t]&&(o[t]=r)},e.prototype.outputToConsole=function(e){var t=this.getNodeMemoryStroge(e);t&&console.log(t)},e.prototype.getAllProps=function(e,t,r){return o.LayaPropParse.getAllProps(e,t,r)},e.prototype.getOrCreatePropStructure=function(e,t,r){return o.LayaPropParse.getOrCreatePropStructure(e,t,r)},e.prototype.walkArr=function(e,t,r){var o,a;if(void 0===r&&(r=null),e)for(a=e.length,o=0;o<a;o++)t.apply(r,[e[o],o])},e.prototype.isShowStat=function(){return this.getLayaInstance().Stat._show},e.prototype.setShowStat=function(e){var t=this.getLayaInstance();return e?(t.Stat.show(),!0):(t.Stat.hide(),!1)},e.prototype.initProxy=function(){var e=this.getLayaInstance();if(e&&!e.initProxy){e.initProxy=!0;var t=this,r=e.Node.prototype._childChanged;e.Node.prototype._childChanged=function(e){void 0===e&&(e=null),r.apply(this,[e]),t.isTreeDirty=!0}}},e.prototype.setTreeDirty=function(e){this.isTreeDirty=e},e}();t.LayaEngineHolder=n},820:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NanoManager=void 0;var o=r(624),a=r(317),n=r(548),i=r(611),s=function(){function e(){this.isActive=!1,this.heartbeatInterval=null,this.upperId=null,this.treeRefreshTimer=null,this.refreshTime=1e3,this.lastRefreshTime=0,this.layaEngineHolder=new o.LayaEngineHolder,this.layaEngineHolder.initProxy()}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.start=function(){this.isActive?n.Logger.log("NanoManager已经处于活动状态"):(this.isActive=!0,n.Logger.log("NanoManager已启动"),this.registerMessageHandler())},e.prototype.stop=function(){this.isActive?(this.isActive=!1,n.Logger.log("NanoManager已停止"),this.clearHeartbeat(),this.unregisterMessageHandler()):n.Logger.log("NanoManager已经处于停止状态")},e.prototype.registerMessageHandler=function(){var e=this;i.WechatHelper.socketTask?(i.WechatHelper.socketTask.onMessage(function(t){e.handleMessage(t.data)}),n.Logger.log("已注册WebSocket消息处理函数")):n.Logger.warn("无法注册WebSocket消息处理函数：socketTask不存在")},e.prototype.unregisterMessageHandler=function(){n.Logger.log("已取消WebSocket消息处理")},e.prototype.handleMessage=function(e){if(this.isActive)try{var t=JSON.parse(e),r=t.type;switch(n.Logger.log("收到WebSocket消息:",r),r){case a.MessageType.LOWER_CONNECT_FAIL:i.WechatHelper.showNotification("连接失败","success");break;case a.MessageType.LOWER_CONNECT_SUCCESS:i.WechatHelper.showNotification("连接成功","success"),this.upperId=t.upperId,this.startHeartbeat(),this.requestAutoUpdateFlag(),this.sendLayaEngineStatus();break;case a.MessageType.REFRESH_NODE_TREE_REQUEST:n.Logger.log("收到刷新节点树请求"),this.handleGetNodeTree();break;case a.MessageType.REQUEST_NODE_PROPERTY:this.handleGetNodeProperty(t.exId);break;case a.MessageType.SET_NODE_PROPERTY_REQUEST:this.handleSetNodeProperty(t);break;case a.MessageType.SET_TIMESCALE_REQUEST:this.handleSetTimeScale(t);break;case a.MessageType.NEXT_FRAME_REQUEST:this.handleNextFrame(t);break;case a.MessageType.HEARTBEAT:n.Logger.log("收到心跳包");break;case a.MessageType.SET_AUTO_UPDATE_FLAG:this.handleSetAutoUpdateFlag(t);break;case a.MessageType.STAT_REQUEST:this.handleStatRequest(t);break;default:n.Logger.warn("未知的消息类型:",r)}}catch(e){n.Logger.error("处理WebSocket消息失败:",e)}else n.Logger.log("NanoManager未启动，忽略消息")},e.prototype.handleGetNodeTree=function(){try{var e=this.layaEngineHolder.refreshTree(),t={type:a.MessageType.REFRESH_NODE_TREE_RESPONSE,targetId:this.upperId,success:!0,data:e};this.sendMessage(t),n.Logger.log("节点树数据已发送")}catch(e){n.Logger.error("获取节点树失败:",e),this.sendMessage({type:a.MessageType.REFRESH_NODE_TREE_RESPONSE,targetId:this.upperId,success:!1,error:"获取节点树失败"})}},e.prototype.handleGetNodeProperty=function(e){try{if(null==e)throw new Error("缺少exId参数");var t=this.layaEngineHolder.getNodeProperty(e),r={type:a.MessageType.NODE_PROPERTY_RESPONSE,success:!0,exId:e,targetId:this.upperId,property:t};this.sendMessage(r),n.Logger.log("节点属性已发送，exId: ".concat(e))}catch(e){n.Logger.error("获取节点属性失败:",e),this.sendMessage({type:a.MessageType.NODE_PROPERTY_RESPONSE,success:!1,exId:0,targetId:this.upperId,property:[]})}},e.prototype.handleSetNodeProperty=function(e){try{var t=e.exId,r=e.componentType,o=e.propertyName,i=e.value;if(null==t)throw new Error("缺少exId参数");if(!r)throw new Error("缺少componentType参数");if(!o)throw new Error("缺少propertyName参数");var s=this.layaEngineHolder.setNodeProperty(t,r,o,i),c={type:a.MessageType.SET_NODE_PROPERTY_RESPONSE,success:s,targetId:this.upperId,exId:t,componentType:r,propertyName:o,value:i};this.sendMessage(c),n.Logger.log("节点属性设置".concat(s?"成功":"失败","，exId: ").concat(t,", property: ").concat(r,".").concat(o))}catch(e){n.Logger.error("设置节点属性失败:",e),this.sendMessage({type:a.MessageType.SET_NODE_PROPERTY_RESPONSE,success:!1,error:"设置节点属性失败"})}},e.prototype.handleSetTimeScale=function(e){try{var t=parseFloat(e.timeScale);if(isNaN(t))throw new Error("无效的timeScale值");var r=this.layaEngineHolder.setTimeScale(t),o={type:a.MessageType.SET_TIMESCALE_RESPONSE,success:!0,targetId:this.upperId,data:{timeScale:r}};this.sendMessage(o),n.Logger.log("timeScale已设置为".concat(r))}catch(e){n.Logger.error("设置timeScale失败:",e),this.sendMessage({type:a.MessageType.SET_TIMESCALE_RESPONSE,success:!1,targetId:this.upperId,error:"设置timeScale失败"})}},e.prototype.handleNextFrame=function(e){try{n.Logger.log("收到下一帧请求"),this.layaEngineHolder.nextFrame()}catch(e){n.Logger.error("执行下一帧失败:",e)}},e.prototype.handleStatRequest=function(e){var t=this.layaEngineHolder.setShowStat(e.isShow),r={type:a.MessageType.STAT_RESPONSE,success:!0,targetId:this.upperId,isShow:t};this.sendMessage(r),n.Logger.log("状态请求处理完成，isShow:",t)},e.prototype.startHeartbeat=function(){var e=this;this.clearHeartbeat(),this.heartbeatInterval=setInterval(function(){if(i.WechatHelper.socketTask)try{e.sendMessage({type:a.MessageType.HEARTBEAT}),n.Logger.log("已发送心跳包")}catch(e){n.Logger.error("发送心跳包失败:",e)}},3e4),n.Logger.log("心跳定时器已启动")},e.prototype.clearHeartbeat=function(){null!==this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null,n.Logger.log("心跳定时器已清除"))},e.prototype.requestAutoUpdateFlag=function(){if(this.upperId){var e={type:a.MessageType.GET_AUTO_UPDATE_FLAG,targetId:this.upperId};this.sendMessage(e),n.Logger.log("已发送获取自动更新标志请求")}else n.Logger.error("上位机ID不存在，无法请求自动更新标志")},e.prototype.sendLayaEngineStatus=function(){var e=this.layaEngineHolder.isShowStat(),t={type:a.MessageType.STAT_RESPONSE,success:!0,targetId:this.upperId,data:{isShow:e}};this.sendMessage(t)},e.prototype.handleSetAutoUpdateFlag=function(e){try{n.Logger.log("收到自动更新标志响应，发送者:",e.senderId,"标志值:",e.autoUpdateFlag),e.autoUpdateFlag?this.startTreeRefreshTimer():this.stopTreeRefreshTimer()}catch(e){n.Logger.error("处理自动更新标志响应失败:",e)}},e.prototype.startTreeRefreshTimer=function(){var e=this;this.treeRefreshTimer&&clearInterval(this.treeRefreshTimer),this.treeRefreshTimer=setInterval(function(){if(e.layaEngineHolder.isTreeDirty){var t=Date.now();if(t-e.lastRefreshTime<e.refreshTime)return;n.Logger.log("检测到树结构变化，自动刷新树形结构"),e.handleGetNodeTree(),e.lastRefreshTime=t,e.layaEngineHolder.setTreeDirty?e.layaEngineHolder.setTreeDirty(!1):e.layaEngineHolder.isTreeDirty=!1}},500),n.Logger.log("已启动基于isTreeDirty的定时刷新机制（带防抖）")},e.prototype.stopTreeRefreshTimer=function(){this.treeRefreshTimer&&(clearInterval(this.treeRefreshTimer),this.treeRefreshTimer=null,n.Logger.log("定时刷新定时器已清除"))},e.prototype.sendMessage=function(e){if(i.WechatHelper.socketTask)try{var t=JSON.stringify(e);i.WechatHelper.socketTask.send({data:t,success:function(){n.Logger.log("消息发送成功:",e.type)},fail:function(e){n.Logger.error("消息发送失败:",e)}})}catch(e){n.Logger.error("消息序列化失败:",e)}else n.Logger.warn("无法发送消息：socketTask不存在")},e}();t.NanoManager=s}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,a),n.exports}e=a(548),t=a(417),a(317),new(function(){function r(){this.init()}return r.prototype.handleDebugButtonClick=function(){t.ConnectionHelper.showIpInputDialog()},r.prototype.init=function(){var t=this;if(window.Laya){e.Logger.log("Laya版本: ",window.Laya.LayaEnv.version);var r=setInterval(function(){window.stage&&(clearInterval(r),t.createDebugLayer())},100)}},r.prototype.createDebugLayer=function(){var t=window.Laya,r=new t.Sprite;return r.name="LayaTreeDebugLayer",r.zOrder=999999,t.stage.addChild(r),e.Logger.log("Debug层已创建并添加到舞台"),this.createDraggableDebugButton(r),r.on(t.Event.REMOVED,null,function(){e.Logger.log("Debug层被移除，1秒后重新添加"),setTimeout(function(){r.parent||(t.stage.addChild(r),e.Logger.log("Debug层已重新添加到舞台"))},1e3)}),r},r.prototype.createDraggableDebugButton=function(t){var r=this,o=window.Laya,a=new o.Sprite;a.name="DebugButton",a.size(48,48),a.pos(50,500);var n=new o.Graphics;n.drawRect(0,0,48,48,"#00000000"),a.graphics=n;var i=new o.Sprite;o.loader.load(e.base64Img,o.Handler.create(null,function(e){e&&i.graphics.drawTexture(e,0,0,48,48)})),i.size(48,48),i.pos(0,0),a.addChild(i),t.addChild(a);var s=!1,c=0,g=0,l=0,u=0;a.on(o.Event.MOUSE_DOWN,null,function(e){s=!0,c=e.stageX,g=e.stageY,l=a.x,u=a.y,o.stage.on(o.Event.MOUSE_MOVE,null,p),o.stage.on(o.Event.MOUSE_UP,null,d)});var p=function(e){if(s){var t=e.stageX-c,r=e.stageY-g;a.pos(l+t,u+r)}},d=function(e){if(s){s=!1,o.stage.off(o.Event.MOUSE_MOVE,null,p),o.stage.off(o.Event.MOUSE_UP,null,d);var t=Math.abs(e.stageX-c),a=Math.abs(e.stageY-g);t<5&&a<5&&r.handleDebugButtonClick()}};e.Logger.log("可拖动的Debug按钮已创建")},r}())})();